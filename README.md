# 基于koa2+ts+websocket的多人实时聊天室

### 项目介绍：
本项目是一个简单的基于websocket通信的聊天室项目
本项目功能主要分为：
**群聊**、**私聊**


### 项目技术栈：
前端：

- **jQuery** View层相关操作

后端：

 - **koa2** 基于koa2的nodeJs框架(包括自带的koa-router，koa-static等模块)
 - **typescript** 增加类型检测等，增强代码鲁棒性
 - **mysql**

通讯方式(模块)：

 - **websocket** websocket可以由客户端与服务器端任意一端发起通讯请求。同时，服务器端可以向所有(指定)客户端**广播**信息，非常符合多人实时聊天室的项目需求！
 - **socket.io**  本项目使用socket.io实现通讯。(下面会讲到技术选型原因)

包管理工具：

- **npm**



### 启动方式：
本项目共分为三块内容：

- 第一步

    下载相关包

进入到```koa-demo```文件夹下
```
    npm install // 下载包
```
 - 第二步
    编译ts文件
   

进入到```koa-demo```文件夹下
```
    tsc // 将ts文件编译
```
 - 第三步
    运行项目

进入到```koa-demo```文件夹下
```
    npm run start // 运行

    localhost:3000 // 查看项目
```

### 学习经历及技术选型：

此项目从6.1日起正式开始学习
- 6.1 了解websocket协议，以及多个常用类库，如：ws，node-websocket，socket.io等
其中，socket.io不单包含websocket通讯方式，还包括轮询机制以及其他实现方式，其次socket.io有健全的文档，(ws的文档只有全英的，而且没找到分房机制...)，最后socket.io在客户端同样提供了健全的api，不用写原生的h5的websocket。
- 6.2 使用ts以及websocket的通讯方式跑通koa2框架下的项目。
- 6.3 实现**群聊**功能，了解socket.io的广播，由于只有用户落地数据库，如何做到持久化和各种情况下的提示信息。
- 6.4 实现**私聊**功能，该功能核心问题，socket.io的如何分房，如何邀请他人
- 6.5 完善项目不足之处,完善文档。

### 不足之处：

该项目在使用ts时，本应是加强项代码的可读性。但是由于学习尚浅，有些地方使用可能不恰当。 应多加强项目源码的阅读以及学习，来增加使用ts的机会。
在一些业务逻辑处理方面，可能并不优雅。待日后改进

测压代码websocket-bench -a 10 -c 1 -g generator.js -k  http://localhost:3000/  -o opt.log